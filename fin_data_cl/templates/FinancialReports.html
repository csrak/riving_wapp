{% extends "base.html" %}

{% block content %}
<div class="container-fluid mt-4">
    <div class="row">
        <!-- Left Side -->
        <div class="col-md-6 px-4">
            <h1 class="mb-4">Search Financial Report #1</h1>

            <form method="post" class="mb-4">
                {% csrf_token %}
                <input type="hidden" name="form_id" value="left">
                <div class="row g-3 align-items-center">
                    <div class="col-auto">
                        {{ form_left.ticker.label_tag }} {{ form_left.ticker }}
                    </div>
                    <div class="col-auto">
                        {{ form_left.year.label_tag }} {{ form_left.year }}
                    </div>
                    <div class="col-auto">
                        {{ form_left.month.label_tag }} {{ form_left.month }}
                    </div>
                    <div class="col-auto">
                        <button type="submit" class="btn btn-primary">Search</button>
                    </div>
                </div>
            </form>

            {% if report_left %}
                <div class="accordion" id="financialReportAccordionLeft">
                    <!-- Business Overview -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingOverviewLeft">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOverviewLeft" aria-expanded="true" aria-controls="collapseOverviewLeft">
                                Business Overview
                            </button>
                        </h2>
                        <div id="collapseOverviewLeft" class="accordion-collapse collapse show" aria-labelledby="headingOverviewLeft" data-bs-parent="#financialReportAccordionLeft">
                            <div class="accordion-body">
                                <p>{{ report_left.business_overview }}</p>
                            </div>
                        </div>
                    </div>

                    <!-- Risks -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingRisksLeft">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseRisksLeft" aria-expanded="false" aria-controls="collapseRisksLeft">
                                Risks
                            </button>
                        </h2>
                        <div id="collapseRisksLeft" class="accordion-collapse collapse" aria-labelledby="headingRisksLeft" data-bs-parent="#financialReportAccordionLeft">
                            <div class="accordion-body">
                                {% for risk in report_left.risks %}
                                    {% if risk.description|wordcount >= 10 %}
                                        <p><strong>Description:</strong> {{ risk.description }}</p>
                                        <hr>
                                    {% endif %}
                                {% endfor %}
                            </div>
                        </div>
                    </div>

                    <!-- Historical Changes -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingChangesLeft">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseChangesLeft" aria-expanded="false" aria-controls="collapseChangesLeft">
                                Historical Changes
                            </button>
                        </h2>
                        <div id="collapseChangesLeft" class="accordion-collapse collapse" aria-labelledby="headingChangesLeft" data-bs-parent="#financialReportAccordionLeft">
                            <div class="accordion-body">
                                {% for change in report_left.historical_changes %}
                                    {% if change.description|wordcount >= 10 %}
                                        <p><strong>Description:</strong> {{ change.description }}</p>
                                        <hr>
                                    {% endif %}
                                {% endfor %}
                            </div>
                        </div>
                    </div>

                    <!-- Future Outlook -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingOutlookLeft">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOutlookLeft" aria-expanded="false" aria-controls="collapseOutlookLeft">
                                Future Outlook
                            </button>
                        </h2>
                        <div id="collapseOutlookLeft" class="accordion-collapse collapse" aria-labelledby="headingOutlookLeft" data-bs-parent="#financialReportAccordionLeft">
                            <div class="accordion-body">
                                {% for outlook in report_left.future_outlook %}
                                    {% if outlook.description|wordcount >= 10 %}
                                        <p><strong>Description:</strong> {{ outlook.description }}</p>
                                        <hr>
                                    {% endif %}
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
            {% elif report_left is not none %}
                <div class="alert alert-warning mt-4" role="alert">
                    No financial report found for the selected ticker and date.
                </div>
            {% endif %}
        </div>

        <!-- Right Side -->
        <div class="col-md-6 px-4">
            <h1 class="mb-4">Search Financial Report #2</h1>

            <form method="post" class="mb-4">
                {% csrf_token %}
                <input type="hidden" name="form_id" value="right">
                <div class="row g-3 align-items-center">
                    <div class="col-auto">
                        {{ form_right.ticker.label_tag }} {{ form_right.ticker }}
                    </div>
                    <div class="col-auto">
                        {{ form_right.year.label_tag }} {{ form_right.year }}
                    </div>
                    <div class="col-auto">
                        {{ form_right.month.label_tag }} {{ form_right.month }}
                    </div>
                    <div class="col-auto">
                        <button type="submit" class="btn btn-primary">Search</button>
                    </div>
                </div>
            </form>

            {% if report_right %}
                <div class="accordion" id="financialReportAccordionRight">
                    <!-- Business Overview -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingOverviewRight">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOverviewRight" aria-expanded="true" aria-controls="collapseOverviewRight">
                                Business Overview
                            </button>
                        </h2>
                        <div id="collapseOverviewRight" class="accordion-collapse collapse show" aria-labelledby="headingOverviewRight" data-bs-parent="#financialReportAccordionRight">
                            <div class="accordion-body">
                                <p>{{ report_right.business_overview }}</p>
                            </div>
                        </div>
                    </div>

                    <!-- Risks -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingRisksRight">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseRisksRight" aria-expanded="false" aria-controls="collapseRisksRight">
                                Risks
                            </button>
                        </h2>
                        <div id="collapseRisksRight" class="accordion-collapse collapse" aria-labelledby="headingRisksRight" data-bs-parent="#financialReportAccordionRight">
                            <div class="accordion-body">
                                {% for risk in report_right.risks %}
                                    {% if risk.description|wordcount >= 10 %}
                                        <p><strong>Description:</strong> {{ risk.description }}</p>
                                        <hr>
                                    {% endif %}
                                {% endfor %}
                            </div>
                        </div>
                    </div>

                    <!-- Historical Changes -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingChangesRight">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseChangesRight" aria-expanded="false" aria-controls="collapseChangesRight">
                                Historical Changes
                            </button>
                        </h2>
                        <div id="collapseChangesRight" class="accordion-collapse collapse" aria-labelledby="headingChangesRight" data-bs-parent="#financialReportAccordionRight">
                            <div class="accordion-body">
                                {% for change in report_right.historical_changes %}
                                    {% if change.description|wordcount >= 10 %}
                                        <p><strong>Description:</strong> {{ change.description }}</p>
                                        <hr>
                                    {% endif %}
                                {% endfor %}
                            </div>
                        </div>
                    </div>

                    <!-- Future Outlook -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingOutlookRight">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOutlookRight" aria-expanded="false" aria-controls="collapseOutlookRight">
                                Future Outlook
                            </button>
                        </h2>
                        <div id="collapseOutlookRight" class="accordion-collapse collapse" aria-labelledby="headingOutlookRight" data-bs-parent="#financialReportAccordionRight">
                            <div class="accordion-body">
                                {% for outlook in report_right.future_outlook %}
                                    {% if outlook.description|wordcount >= 10 %}
                                        <p><strong>Description:</strong> {{ outlook.description }}</p>
                                        <hr>
                                    {% endif %}
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
            {% elif report_right is not none %}
                <div class="alert alert-warning mt-4" role="alert">
                    No financial report found for the selected ticker and date.
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}